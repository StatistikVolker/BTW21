---
title: "Bundestagswahl 2021"
author: Volker Holzendorf, Stadtverwaltung Jena, FD Controlling und Statistik
output: 
  flexdashboard::flex_dashboard:
    
    orientation: rows
    vertical_layout: fill
runtime: shiny
---

```{r setup, include=FALSE}
source("R-Codes/010_load packages.r")

# Icons:
# https://fontawesome.com/v5.15/icons?d=gallery
# https://fontawesome.com/v5.15/icons?d=gallery&p=2&m=free
# Link to use Icons in R:
# https://www.displayr.com/adding-icons-to-dashboards-using-font-awesome/

# Farben für für die Linien festlegen
Indikatorencols <- c("darkblue","darkgreen","orange")

#C19JTH_data <- function() {
#  read.csv2("https://www.tmasgff.de/fileadmin/user_upload/Gesundheit/COVID-19/Eindaemmungskonzept/Tagesuebersichten/#Uebersicht_Eindaemmungserlass.csv")
#}


  
  
# Datenladen
# Daten wqerden interaktiv geladen
#source("R-Codes/011_load_Data.R")


source("R-Codes/mkr_btw21cartogramparteien.r")
#source("R-Codes/mkr_C19JFWplot_ia.r")

```


#BTW21
=======================================================================

Sidebar {.sidebar}
-----------------------------------------------------------------------

### Gebietswahl für Kartendatstelliung


```{r}
# Gebietswahl Auswahl
gebiet <- c( "Deutschland","Neue Länder (+Berlin)","Leipzig", "Jena")
selectInput("selectGebiet",
            "Wähle ein Gebiet zur Darstellung der Karten aus",
            gebiet,
            selected = "Jena",
            multiple = FALSE)


# Darstellungsart
darstellung <- c( "Parteihochburg","Wahlkreisgewinner")
selectInput("selectDarstellung", 
            "Was soll dargestellt werden?",
            darstellung,
            selected = "Parteihochburg",
            multiple = FALSE)

# Erst- oder ZWeit Stimme?
stimme <-c( "Erststimme","Zweitstimme")
selectInput("selectStimme", 
            "Welche Stimme der Wahl soll betrachtet werden?",
            stimme,
            selected = "Zweitstimme",
            multiple = FALSE)

if (input$selectDarstellung() == "Parteihochburg"){
  party <-c( "SPD", "CDU/CSU","GRÜNE","FDP","AfD","DIE LINKE")
  selectInput("selectPartei", 
              "Welche Stimme der Wahl soll betrachtet werden?",
              party,
              selected = "",
              multiple = FALSE)
  
}

```

Row
-----------------------------------------------------------------------

### Gebiet {.value-box}



```{r}

# 


# Angabe des Gebietes, das Dargestellt wird
selectedGebiet <- reactive({
  input$selectGebiet
})
renderValueBox({
  valueBox(selectedGebiet(), icon = "fa-calendar", color = "cornflowerblue")
})
```



Row
-----------------------------------------------------------------------


### Art der Auswertung {.value-box}

```{r}
selectedDarstellung <- reactive({
  input$selectDarstellung
})
renderValueBox({
  valueBox(selectedDarstellung(), icon = "fa-calendar", color = "darkblue") 
```


### Ausgewertete (Wahl-)Stimme {.value-box}

```{r}
selectedStimme <- reactive({
  input$selectStimme
})
renderValueBox({
  valueBox(selectStimme(), icon = "fa-calendar", color = "darkblue") # Farbe für Stimmenartß
})
```


### Betrachtete Partei {.value-box}

```{r}
selectedPartei <- reactive({
  input$selectPartei
})
if (selectedDarstellung() == "Parteihochburg") {
  renderValueBox({
    valueBox(selectPartei(), icon = "fa-calendar", color = "darkblue") # Box in Parteifarbe
  })
}
```



Row 
-----------------------------------------------------------------------


### Unverzerrte Karte

```{r}


#renderPlotly({
#  p1 <- mkr.C19JFWplot_ia(
#    dfplot = dfplot1(), #dataset
#    Indikator = Indikatorenval[2], # Warnndikator
#    vglLKs = selectedSK(),
#    Fusszeile = "7-Tage-Inzidenz: tägliche Linelist des Thüringer Landesamt für Verbraucherschutz", #
#    warnstufeny = c(35,100,200), # Vector der Warnstufen
#    warncols = c("gold","orange","red"),
#    linecol = Indikatorencols[2], # Farbe der Linie
#    ystepv = c(10,25,50), # y-Achsen Werte
#    maxy = max(dfplot1()$Werte), # maximaler y Wert
#    mindat = mindat, # Minimales Datum
#    maxdat = maxdat, # maximales Datum
#    stepdat = "week"
#    
#  )
#  p1 %>% ggplotly(tooltip = c("y", "x","alpha")) %>% layout(legend = list(orientation = 'h'))

})



```


### Cartogramm

```{r}

```

